function refererHandle(a){"use strict";for(var b=0;b<a.requestHeaders.length;b+=1)if("Referer"===a.requestHeaders[b].name){a.requestHeaders[b].value=a.url;break}return{requestHeaders:a.requestHeaders}}chrome.webRequest.onBeforeSendHeaders.addListener(function(a){"use strict";for(var b=0;b<a.requestHeaders.length;b+=1)if("Referer"===a.requestHeaders[b].name){a.requestHeaders[b].value="http://www.bttiantang.com/download.php";break}return{requestHeaders:a.requestHeaders}},{urls:["http://192.184.95.23/?infohash=*"]},["blocking","requestHeaders"]),chrome.webRequest.onBeforeSendHeaders.addListener(function(a){"use strict";for(var b=0;b<a.requestHeaders.length;b+=1)if("Referer"===a.requestHeaders[b].name){a.requestHeaders[b].value=a.url;break}return{requestHeaders:a.requestHeaders}},{urls:["http://*/bt*/down.php","http://i.vod.xunlei.com/*"]},["blocking","requestHeaders"]);var urls=[];chrome.runtime.onMessage.addListener(function(a,b,c){"use strict";if("cookie"===a.action){var d=a.data.name;return chrome.cookies.get({url:"http://vod.xunlei.com",name:d},function(a){var b=a?a.value:"";c(b)}),!0}if("referer"===a.action){var e=a.data.url;-1===urls.indexOf(e)&&(urls.push(e),chrome.webRequest.onBeforeSendHeaders.removeListener(refererHandle),chrome.webRequest.onBeforeSendHeaders.addListener(refererHandle,{urls:urls},["blocking","requestHeaders"]))}else if("openurl"===a.action){var f=a.data.url;f&&chrome.tabs.create({url:f})}});